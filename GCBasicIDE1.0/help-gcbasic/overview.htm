<html><head>
   <title>I2C Overview</title>
   <meta name="generator"  content="HelpMaker.net" >
   <meta name="keywords"  content="I2C Overview," ></head>
<body bgcolor="FFFCEA" >
<table width="100%"  border="0"  cellspacing="0"  cellpadding="2"  bgcolor="C0C0C0" >
  <tr>
    <td align="left" >
      <div align="left" ><font face="Arial"  color="#010101"  size="4" ><span style="font-size:14pt" >I2C Overview</span></font><font color="#010101" ></font></div>

    </td>
    <td align="right" >
      <font face="Arial"  size="2" >
        <a href="spimode.htm">Previous</a>&nbsp;&nbsp;<a href="i2cackpoll.htm">Next</a>
      </font>
    </td>
  </tr></table>
<hr><div align="left" ><font face="Arial" ><span style="font-size:12pt" ><b>Introduction:</b></span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Arial"  color="#010101" ><span style="font-size:12pt" >These routines allow GCBASIC programs to send and receive I2C 
messages. They can be configured to act as master or slave, and the 
speed can also be altered.</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><br></div><font color="#010101" ><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ></font><font face="Arial"  color="#010101" ><span style="font-size:12pt" >No hardware I2C module is required for these routines - all 
communication is handled in software. However, these routines will not 
work on 12-bit instruction PICs (10F, 12F5xx and 16F5xx chips).</span></font><font color="#010101" ></font></div><div align="left" ><br></div><font color="#010101" ><div align="left" ></font><font face="Arial"  color="#010101" ><span style="font-size:12pt" ><b>Relevant Constants:</b></span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Arial"  color="#010101" ><span style="font-size:12pt" >These constants control the setup of the software I2C routines:</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font color="#010101" ></font></div><table border="1"  width="576"  cellpadding="3"  cellspacing="0"  style="border-collapse: collapse; border: none" >
    <tr>
    <td align="center"  valign="top"  width="249"  style="border: solid #010101 1px;" >
    <div align="center" ><font face="Arial" ><span style="font-size:12pt" ><b>Constant</b></span></font><font color="#010101" ></font></div>
    </td>
    <td align="center"  valign="top"  width="177"  style="border: solid #010101 1px;" >
    <div align="center" ><font face="Arial" ><span style="font-size:12pt" ><b>Controls</b></span></font><font color="#010101" ></font></div>
    </td>
    <td align="center"  valign="top"  width="123"  style="border: solid #010101 1px;" >
    <div align="center" ><font face="Arial" ><span style="font-size:12pt" ><b>Default Value</b></span></font><font color="#010101" ></font></div>
    </td></tr>
    <tr>
    <td align="center"  valign="top"  width="249"  style="border: solid #010101 1px;" >
    <div align="center" ><font face="Arial"  color="#010101" ><span style="font-size:12pt" >I2C_MODE</span></font><font color="#010101" ></font></div>
    </td>
    <td align="center"  valign="top"  width="177"  style="border: solid #010101 1px;" >
    <div align="center" ><font face="Arial"  color="#010101" ><span style="font-size:12pt" >Mode of I2C routines 
    (Master or Slave)</span></font><font color="#010101" ></font></div>
    </td>
    <td align="center"  valign="top"  width="123"  style="border: solid #010101 1px;" >
    <div align="center" ><font face="Arial"  color="#010101" ><span style="font-size:12pt" >Master</span></font><font color="#010101" ></font></div>
    </td></tr>
    <tr>
    <td align="center"  valign="top"  width="249"  style="border: solid #010101 1px;" >
    <div align="center" ><font face="Arial"  color="#010101" ><span style="font-size:12pt" >I2C_DATA</span></font><font color="#010101" ></font></div>
    </td>
    <td align="center"  valign="top"  width="177"  style="border: solid #010101 1px;" >
    <div align="center" ><font face="Arial"  color="#010101" ><span style="font-size:12pt" >Pin on microcontroller 
    connected to I2C data</span></font><font color="#010101" ></font></div>
    </td>
    <td align="center"  valign="top"  width="123"  style="border: solid #010101 1px;" >
    <div align="center" ><font face="Arial"  color="#010101" ><span style="font-size:12pt" >N/A</span></font><font color="#010101" ></font></div>
    </td></tr>
    <tr>
    <td align="center"  valign="top"  width="249"  style="border: solid #010101 1px;" >
    <div align="center" ><font face="Arial"  color="#010101" ><span style="font-size:12pt" >I2C_CLOCK</span></font><font color="#010101" ></font></div>
    </td>
    <td align="center"  valign="top"  width="177"  style="border: solid #010101 1px;" >
    <div align="center" ><font face="Arial"  color="#010101" ><span style="font-size:12pt" >Pin on microcontroller 
    connected to I2C clock</span></font><font color="#010101" ></font></div>
    </td>
    <td align="center"  valign="top"  width="123"  style="border: solid #010101 1px;" >
    <div align="center" ><font face="Arial"  color="#010101" ><span style="font-size:12pt" >N/A</span></font><font color="#010101" ></font></div>
    </td></tr>
    <tr>
    <td align="center"  valign="top"  width="249"  style="border: solid #010101 1px;" >
    <div align="center" ><font face="Arial"  color="#010101" ><span style="font-size:12pt" >I2C_BIT_DELAY</span></font><font color="#010101" ></font></div>
    </td>
    <td align="center"  valign="top"  width="177"  style="border: solid #010101 1px;" >
    <div align="center" ><font face="Arial"  color="#010101" ><span style="font-size:12pt" >Time for a bit (used for 
    acknowledge detection)</span></font><font color="#010101" ></font></div>
    </td>
    <td align="center"  valign="top"  width="123"  style="border: solid #010101 1px;" >
    <div align="center" ><font face="Arial"  color="#010101" ><span style="font-size:12pt" >2 us</span></font><font color="#010101" ></font></div>
    </td></tr>
    <tr>
    <td align="center"  valign="top"  width="249"  style="border: solid #010101 1px;" >
    <div align="center" ><font face="Arial"  color="#010101" ><span style="font-size:12pt" >I2C_CLOCK_DELAY</span></font><font color="#010101" ></font></div>
    </td>
    <td align="center"  valign="top"  width="177"  style="border: solid #010101 1px;" >
    <div align="center" ><font face="Arial"  color="#010101" ><span style="font-size:12pt" >Time for clock pulse to 
    remain high</span></font><font color="#010101" ></font></div>
    </td>
    <td align="center"  valign="top"  width="123"  style="border: solid #010101 1px;" >
    <div align="center" ><font face="Arial"  color="#010101" ><span style="font-size:12pt" >1 us</span></font><font color="#010101" ></font></div>
    </td></tr>
    <tr>
    <td align="center"  valign="top"  width="249"  style="border: solid #010101 1px;" >
    <div align="center" ><font face="Arial"  color="#010101" ><span style="font-size:12pt" >I2C_END_DELAY</span></font><font color="#010101" ></font></div>
    </td>
    <td align="center"  valign="top"  width="177"  style="border: solid #010101 1px;" >
    <div align="center" ><font face="Arial"  color="#010101" ><span style="font-size:12pt" >Time between clock 
    pulses</span></font><font color="#010101" ></font></div>
    </td>
    <td align="center"  valign="top"  width="123"  style="border: solid #010101 1px;" >
    <div align="center" ><font face="Arial"  color="#010101" ><span style="font-size:12pt" >1 us</span></font><font color="#010101" ></font></div>
    </td></tr>
    <tr>
    <td align="center"  valign="top"  width="249"  style="border: solid #010101 1px;" >
    <div align="center" ><font face="Arial"  color="#010101" ><span style="font-size:12pt" >I2C_USE_TIMEOUT</span></font><font color="#010101" ></font></div>
    </td>
    <td align="center"  valign="top"  width="177"  style="border: solid #010101 1px;" >
    <div align="center" ><font face="Arial"  color="#010101" ><span style="font-size:12pt" >Set to true if slave mode 
    I2C routines should stop 
    waiting for the master 
    and exit after a timeout 
    occurs.</span></font><font color="#010101" ></font></div>
    </td>
    <td align="center"  valign="top"  width="123"  style="border: solid #010101 1px;" >
    <div align="center" ><font face="Arial"  color="#010101" ><span style="font-size:12pt" >Not Set</span></font><font color="#010101" ></font></div>
    </td></tr>
    <tr>
    <td valign="top"  width="249"  style="border: solid #010101 1px;" >
    <div align="left" ><font face="Arial"  color="#010101" ><span style="font-size:12pt" >I2C_DISABLE_INTERRUPTS</span></font><font color="#010101" ></font></div>
    </td>
    <td valign="top"  width="177"  style="border: solid #010101 1px;" >
    <div align="left" ><font face="Arial"  color="#010101" ><span style="font-size:12pt" >Disable interrupts during 
    I2C routines.&nbsp; Important 
    when an i2C clock is 
    part of your solution</span></font><font color="#010101" ></font></div>
    </td>
    <td valign="top"  width="123"  style="border: solid #010101 1px;" >
    <div align="left" ><font face="Arial"  color="#010101" ><span style="font-size:12pt" >Only available in 
    GCB compiler 
    post 1/2014</span></font><font color="#010101" ></font></div>
    </td></tr></table><div align="left" ><br></div><font color="#010101" ><div align="left" ></font><font face="Arial" ><span style="font-size:12pt" ><b>Example:</b></span></font><font color="#010101" ></font></div><div align="left" ><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Arial"  color="#010101" ><span style="font-size:12pt" >This example examines the IC2 devices and displays on a terminal.&nbsp;&nbsp; This 
code will require adaption but the code shows an approach to discover the 
IC2 devices.</span></font><font color="#010101" ></font></div><div align="left" ><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Courier New" ><span style="font-size:10pt" >&nbsp; ' change the processor</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Courier New" ><span style="font-size:10pt" >&nbsp; #chip 16F1825,32</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Courier New" ><span style="font-size:10pt" >&nbsp; #config Osc = intOSC, MCLRE_OFF</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Courier New" ><span style="font-size:10pt" >&nbsp; #include &quot;..\outputserial.h&quot;</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><br></div><font color="#010101" ><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><br></font></div><font color="#010101" ><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ></font><font face="Courier New" ><span style="font-size:10pt" >&nbsp; ' Define I2C settings - CHANGE PORTS</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Courier New" ><span style="font-size:10pt" >&nbsp; #define I2C_MODE Master</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Courier New" ><span style="font-size:10pt" >&nbsp; #define I2C_DATA PORTC.5</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Courier New" ><span style="font-size:10pt" >&nbsp; #define I2C_CLOCK PORTC.4</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;<b> #define I2C_DISABLE_INTERRUPTS ON</b></span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><br></div><font color="#010101" ><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ></font><font face="Courier New" ><span style="font-size:10pt" >&nbsp; ' THIS CONFIG OF THE SERIAL PORT WORKS WITH max232 THEN TO PC</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Courier New" ><span style="font-size:10pt" >&nbsp; #define SendAHigh Set PORTC.3 OfF</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Courier New" ><span style="font-size:10pt" >&nbsp; #define SendALow Set PORTC.3 ON</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Courier New" ><span style="font-size:10pt" >&nbsp; Dir PORTC.3 Out</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Courier New" ><span style="font-size:10pt" >&nbsp; #define SerSendDelayms 10</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Courier New" ><span style="font-size:10pt" >&nbsp; 'Set up serial connection</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Courier New" ><span style="font-size:10pt" >&nbsp; InitSer 1, r9600, 1+128, 8, 1, none, INVERT</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Courier New" ><span style="font-size:10pt" >&nbsp; wait SerSendDelayms ms</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><br></div><font color="#010101" ><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ></font><font face="Courier New" ><span style="font-size:10pt" >&nbsp; ANSIERASECREEN_SW</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Courier New" ><span style="font-size:10pt" >&nbsp; ANSI_SW ( 0,0)</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Courier New" ><span style="font-size:10pt" >&nbsp; SerPrint 1,&nbsp; &quot;Started: &quot;</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Courier New" ><span style="font-size:10pt" >&nbsp; wait SerSendDelayms ms</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Courier New" ><span style="font-size:10pt" >&nbsp; SerPrint 1,&nbsp; &quot;Searching I2C address space: v0.82&quot;</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Courier New" ><span style="font-size:10pt" >&nbsp; sersend 1, ( 10)</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Courier New" ><span style="font-size:10pt" >&nbsp; sersend 1, ( 13)</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><br></div><font color="#010101" ><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><br></font></div><font color="#010101" ><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><br></font></div><font color="#010101" ><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><br></font></div><font color="#010101" ><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><br></font></div><font color="#010101" ><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ></font><font face="Courier New" ><span style="font-size:10pt" >&nbsp; dim deviceID as byte</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><br></div><font color="#010101" ><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ></font><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for deviceID = 0 to 255</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; I2CStart</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; I2CSend ( deviceID )</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; i2cstop</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><br></div><font color="#010101" ><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ></font><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if I2CSendState = ACK&nbsp; then</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SerPrint 1,&nbsp; &quot;__&quot;</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SerPrint 1,&nbsp; &quot;ID : 0x&quot;</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SerPrint 1,&nbsp; hex(deviceID)</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SerPrint 1,&nbsp; &quot; (d&quot;</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SerPrint 1,&nbsp; Str(deviceID)</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SerPrint 1,&nbsp; &quot;) - &quot;</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SerSend&nbsp; 1, 9</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SerPrint 1,&nbsp; &quot;I2C Port &quot;: Sersend 1, I2CSendState: 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sersend 1, ( 10):sersend 1, ( 13)</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end if</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; next</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SerPrint 1,&nbsp; &quot;End of Device Search&quot;: sersend 1, ( 
10):sersend 1, ( 13)</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Courier New" ><span style="font-size:10pt" >&nbsp; END</span></font><font color="#010101" ></font></div><div align="left" ><br></div><font color="#010101" ><div align="left" ><br></font></div><font color="#010101" ><div align="left" ></font><font color="#010101" ></font></div>

</html>
